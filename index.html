<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="shortcut icon" href="logo.png" type="image/x-icon" />
    <link
      rel="stylesheet"
      href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css"
    />
    <script>
      // Burger menus
      document.addEventListener("DOMContentLoaded", function () {
        // open
        const burger = document.querySelectorAll(".navbar-burger");
        const menu = document.querySelectorAll(".navbar-menu");

        if (burger.length && menu.length) {
          for (var i = 0; i < burger.length; i++) {
            burger[i].addEventListener("click", function () {
              for (var j = 0; j < menu.length; j++) {
                menu[j].classList.toggle("hidden");
              }
            });
          }
        }

        // close
        const close = document.querySelectorAll(".navbar-close");
        const backdrop = document.querySelectorAll(".navbar-backdrop");

        if (close.length) {
          for (var i = 0; i < close.length; i++) {
            close[i].addEventListener("click", function () {
              for (var j = 0; j < menu.length; j++) {
                menu[j].classList.toggle("hidden");
              }
            });
          }
        }

        if (backdrop.length) {
          for (var i = 0; i < backdrop.length; i++) {
            backdrop[i].addEventListener("click", function () {
              for (var j = 0; j < menu.length; j++) {
                menu[j].classList.toggle("hidden");
              }
            });
          }
        }
      });
    </script>
  </head>
  <body>
    <nav class="relative px-4 py-4 flex justify-between items-center bg-white">
      <img class="w-16 rounded-full" src="logo.png" alt="Dhavya" />
      <a href="index.html" class="flex items-center">
        &nbsp; &nbsp; &nbsp;
        <span
          class="self-center whitespace-nowrap text-2xl font-semibold text-transparent bg-clip-text bg-gradient-to-r to-emerald-600 from-sky-400"
          >धव्य</span
        >
      </a>
      <div class="lg:hidden">
        <button class="navbar-burger flex items-center text-blue-600 p-3">
          <svg
            class="block h-4 w-4 fill-current"
            viewBox="0 0 20 20"
            xmlns="http://www.w3.org/2000/svg"
          >
            <title>Mobile menu</title>
            <path d="M0 3h20v2H0V3zm0 6h20v2H0V9zm0 6h20v2H0v-2z"></path>
          </svg>
        </button>
      </div>
      <a
        class="hidden lg:inline-block lg:ml-auto lg:mr-3 py-2 px-6 bg-gray-50 hover:bg-gray-100 text-sm text-gray-900 font-bold rounded-xl transition duration-200"
        href="index.html"
        >Home</a
      >
      &nbsp;

      <a
        class="hidden lg:inline-block py-2 px-6 bg-blue-500 hover:bg-blue-600 text-sm text-white font-bold rounded-xl transition duration-200"
        href="#order"
        >Order</a
      >
    </nav>
    <div class="navbar-menu relative z-50 hidden">
      <div class="navbar-backdrop fixed inset-0 bg-gray-800 opacity-25"></div>
      <nav
        class="fixed top-0 left-0 bottom-0 flex flex-col w-5/6 max-w-sm py-6 px-6 bg-white border-r overflow-y-auto"
      >
        <div class="flex items-center mb-8">
          <img class="w-16 rounded-full" src="logo.png" alt="Dhavya" />
          &nbsp;&nbsp;&nbsp; &nbsp; &nbsp;
          <a href="index.html" class="flex items-center">
            <span
              class="self-center whitespace-nowrap text-2xl font-semibold text-transparent bg-clip-text bg-gradient-to-r to-emerald-600 from-sky-400"
              >धव्य</span
            >
          </a>
          &nbsp;&nbsp;&nbsp;&nbsp;
          <button class="navbar-close">
            <svg
              class="h-6 w-6 text-gray-400 cursor-pointer hover:text-gray-500"
              xmlns="http://www.w3.org/2000/svg"
              fill="none"
              viewBox="0 0 24 24"
              stroke="currentColor"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M6 18L18 6M6 6l12 12"
              ></path>
            </svg>
          </button>
        </div>
        <div>
          <ul>
            <li class="mb-1">
              <a
                class="block p-4 text-sm font-semibold text-gray-400 hover:bg-blue-50 hover:text-blue-600 rounded"
                href="index.html"
                >Home</a
              >
            </li>

            <li class="mb-1">
              <a
                class="block p-4 text-sm font-semibold text-gray-400 hover:bg-blue-50 hover:text-blue-600 rounded"
                href="#order"
                >Order</a
              >
            </li>
          </ul>
        </div>

        <p class="my-4 text-xs text-center text-gray-400">
          <span>
            <img
              class="w-8 rounded-full"
              src="Alogo.png"
              alt="Aghora Innovation"
            />
            <span>Copyright © 2025</span> &nbsp; A unit of Aghora
            Innovation</span
          >
        </p>
      </nav>
    </div>

    <!-- Typewriter effect  -->
    <div class="w-full h-full flex justify-center items-center">
      <h2>
        <span
          class="text-3xl font-bold from-30% from-[#FF8E26] to-55% to-[#0163E0] inline-block bg-gradient-to-r bg-clip-text text-transparent"
          id="typewriter"
        >
        </span>
      </h2>
    </div>
    <script>
      const words = ["Jai Sri Ram", "Welcome to", " Dhavya Laundry Service"];
      let i = 0;
      let j = 0;
      let currentWord = "";
      let isDeleting = false;

      function type() {
        currentWord = words[i];
        if (isDeleting) {
          document.getElementById("typewriter").textContent =
            currentWord.substring(0, j - 1);
          j--;
          if (j == 0) {
            isDeleting = false;
            i++;
            if (i == words.length) {
              i = 0;
            }
          }
        } else {
          document.getElementById("typewriter").textContent =
            currentWord.substring(0, j + 1);
          j++;
          if (j == currentWord.length) {
            isDeleting = true;
          }
        }
        setTimeout(type, 100);
      }
      type();
    </script>
    <br />
    <div class="bg-gray-100 p-6" id="order">
      <div class="flex gap-6">
        <!-- Order Form -->
        <div class="w-1/3 bg-white p-6 rounded-2xl shadow">
          <h2 class="text-xl font-semibold mb-4">Order Form</h2>
          <form id="contactForm" class="space-y-4">
            <input
              id="name"
              type="text"
              placeholder="Name"
              class="w-full border rounded p-2"
              required
            />
            <input
              id="number"
              type="text"
              placeholder="Number"
              class="w-full border rounded p-2"
              required
            />
            <input
              id="billNumber"
              type="text"
              placeholder="Bill Number"
              class="w-full border rounded p-2"
              required
            />
            <input
              id="location"
              type="text"
              placeholder="Location"
              class="w-full border rounded p-2"
              required
            />

            <div id="itemsContainer" class="space-y-2">
              <div class="flex gap-2 item-row">
                <input
                  type="text"
                  placeholder="Item Name"
                  class="item-name flex-1 border rounded p-2"
                  required
                />
                <input
                  type="number"
                  placeholder="Quantity"
                  class="item-quantity w-32 border rounded p-2"
                  required
                />
              </div>
            </div>

            <button
              type="button"
              id="addItemBtn"
              class="bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700"
            >
              Add Item
            </button>

            <input
              id="totalWeight"
              placeholder="Total Weight (g)"
              class="w-full border rounded p-2 mt-4"
              required
            />
            <input
              id="totalCost"
              readonly
              placeholder="Total Cost (₹)"
              class="w-full bg-gray-100 border rounded p-2"
            />

            <!-- Advance and Remaining Amount Fields -->
            <input
              id="advanceAmount"
              type="number"
              placeholder="Advance Amount (₹)"
              class="w-full border rounded p-2 mt-4"
            />
            <input
              id="remainingAmount"
              readonly
              placeholder="Remaining Amount (₹)"
              class="w-full bg-gray-100 border rounded p-2 mt-4"
            />

            <button
              type="submit"
              class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 w-full"
            >
              Submit
            </button>
          </form>
        </div>

        <!-- Records Table -->
        <div class="w-2/3 bg-white p-6 rounded-2xl shadow overflow-auto">
          <h2 class="text-xl font-semibold mb-4">Submitted Records</h2>
          <table
            class="w-full table-auto border-collapse border border-gray-300"
          >
            <thead>
              <tr class="bg-gray-100 text-sm">
                <th class="border px-4 py-2">Name</th>
                <th class="border px-4 py-2">Number</th>
                <th class="border px-4 py-2">Bill #</th>
                <th class="border px-4 py-2">Location</th>
                <th class="border px-4 py-2">Weight (g)</th>
                <th class="border px-4 py-2">Cost (₹)</th>
                <th class="border px-4 py-2">Status</th>
                <!-- Added Status Column -->
                <th class="border px-4 py-2">Delete</th>
                <th class="border px-4 py-2">Save</th>
              </tr>
            </thead>
            <tbody id="tableBody">
              <tr>
                <td colspan="9" class="text-center text-gray-500 py-4">
                  No entries yet
                </td>
              </tr>
            </tbody>
          </table>
          <div id="qrcode" class="mt-4"></div>

          <!-- Export to CSV Button -->
          <button
            id="exportCsvBtn"
            class="mt-4 bg-yellow-600 text-white px-4 py-2 rounded hover:bg-yellow-700"
          >
            Export to CSV
          </button>
        </div>
      </div>
    </div>

    <script>
      const itemsContainer = document.getElementById("itemsContainer");
      const addItemBtn = document.getElementById("addItemBtn");
      const totalWeightInput = document.getElementById("totalWeight");
      const totalCostInput = document.getElementById("totalCost");
      const advanceAmountInput = document.getElementById("advanceAmount");
      const remainingAmountInput = document.getElementById("remainingAmount");
      const tableBody = document.getElementById("tableBody");

      function calculateTotals() {
        const totalWeight = parseFloat(totalWeightInput.value) || 0;
        const totalCost = totalWeight * 0.05;
        totalCostInput.value = `₹${totalCost.toFixed(2)}`;

        const advanceAmount = parseFloat(advanceAmountInput.value) || 0;
        const remainingAmount = totalCost - advanceAmount;
        remainingAmountInput.value = `₹${remainingAmount.toFixed(2)}`;
      }

      totalWeightInput.addEventListener("input", calculateTotals);
      advanceAmountInput.addEventListener("input", calculateTotals);

      addItemBtn.addEventListener("click", () => {
        const row = document.createElement("div");
        row.className = "flex gap-2 item-row";
        row.innerHTML = `
            <input type="text" placeholder="Item Name" class="item-name flex-1 border rounded p-2" required />
            <input type="number" placeholder="Quantity" class="item-quantity w-32 border rounded p-2" required />
          `;
        itemsContainer.appendChild(row);
      });

      document
        .getElementById("contactForm")
        .addEventListener("submit", function (e) {
          e.preventDefault();
          const name = document.getElementById("name").value;
          const number = document.getElementById("number").value;
          const billNumber = document.getElementById("billNumber").value;
          const location = document.getElementById("location").value;
          const totalWeight = totalWeightInput.value;
          const totalCost = totalCostInput.value;
          const advanceAmount = advanceAmountInput.value;
          const remainingAmount = remainingAmountInput.value;

          if (
            tableBody.children.length === 1 &&
            tableBody.children[0].children[0].colSpan === 9
          ) {
            tableBody.innerHTML = "";
          }

          const newRow = document.createElement("tr");
          newRow.innerHTML = `
              <td class="border px-4 py-2">${name}</td>
              <td class="border px-4 py-2">${number}</td>
              <td class="border px-4 py-2">${billNumber}</td>
              <td class="border px-4 py-2">${location}</td>
              <td class="border px-4 py-2">${totalWeight}</td>
              <td class="border px-4 py-2">${totalCost}</td>
              <td class="border px-4 py-2">
                <select class="status-select border rounded p-1">
                  <option value="Pending">Pending</option>
                  <option value="Delivered">Delivered</option>
                </select>
              </td>
              <td class="border px-4 py-2">
                <button class="delete-btn bg-red-600 text-white px-3 py-1 rounded hover:bg-red-700">Delete</button>
              </td>
              <td class="border px-4 py-2">
                <button class="save-btn bg-green-600 text-white px-3 py-1 rounded hover:bg-green-700">Save</button>
              </td>
            `;
          tableBody.appendChild(newRow);
          saveToLocalStorage();
          this.reset();
          totalCostInput.value = "";
          advanceAmountInput.value = "";
          remainingAmountInput.value = "";
          itemsContainer.innerHTML = `<div class="flex gap-2 item-row">
            <input type="text" placeholder="Item Name" class="item-name flex-1 border rounded p-2" required />
            <input type="number" placeholder="Quantity" class="item-quantity w-32 border rounded p-2" required />
          </div>`;
        });

      tableBody.addEventListener("click", function (e) {
        const row = e.target.closest("tr");
        if (e.target.classList.contains("delete-btn")) {
          row.remove();
          saveToLocalStorage();
        }
        if (e.target.classList.contains("save-btn")) {
          saveToLocalStorage();
        }
      });

      function saveToLocalStorage() {
        const data = Array.from(tableBody.querySelectorAll("tr")).map((row) => {
          const cells = row.querySelectorAll("td");
          return {
            name: cells[0]?.textContent,
            number: cells[1]?.textContent,
            billNumber: cells[2]?.textContent,
            location: cells[3]?.textContent,
            weight: cells[4]?.textContent,
            cost: cells[5]?.textContent,
            status: cells[6]?.querySelector("select")?.value, // Saving Status
          };
        });
        localStorage.setItem("formData", JSON.stringify(data));
      }

      function loadFromLocalStorage() {
        const data = JSON.parse(localStorage.getItem("formData") || "[]");
        if (data.length) tableBody.innerHTML = "";
        data.forEach((item) => {
          const newRow = document.createElement("tr");
          newRow.innerHTML = `
              <td class="border px-4 py-2">${item.name}</td>
              <td class="border px-4 py-2">${item.number}</td>
              <td class="border px-4 py-2">${item.billNumber}</td>
              <td class="border px-4 py-2">${item.location}</td>
              <td class="border px-4 py-2">${item.weight}</td>
              <td class="border px-4 py-2">${item.cost}</td>
              <td class="border px-4 py-2">
                <select class="status-select border rounded p-1">
                  <option value="Pending" ${
                    item.status === "Pending" ? "selected" : ""
                  }>Pending</option>
                  <option value="Delivered" ${
                    item.status === "Delivered" ? "selected" : ""
                  }>Delivered</option>
                </select>
              </td>
              <td class="border px-4 py-2">
                <button class="delete-btn bg-red-600 text-white px-3 py-1 rounded hover:bg-red-700">Delete</button>
              </td>
              <td class="border px-4 py-2">
                <button class="save-btn bg-green-600 text-white px-3 py-1 rounded hover:bg-green-700">Save</button>
              </td>
            `;
          tableBody.appendChild(newRow);
        });
      }

      window.onload = loadFromLocalStorage;

      // Export to CSV function
      document
        .getElementById("exportCsvBtn")
        .addEventListener("click", function () {
          const rows = Array.from(tableBody.querySelectorAll("tr"));
          const csvRows = [];

          // Get table headers
          const headers = [
            "Name",
            "Number",
            "Bill #",
            "Location",
            "Weight (g)",
            "Cost (₹)",
            "Status",
          ];
          csvRows.push(headers.join(","));

          // Get table data
          rows.forEach((row) => {
            const cols = row.querySelectorAll("td");
            const rowData = Array.from(cols).map((col) => col.innerText);
            csvRows.push(rowData.join(","));
          });

          const csvContent = csvRows.join("\n");
          const blob = new Blob([csvContent], {
            type: "text/csv;charset=utf-8;",
          });
          const link = document.createElement("a");
          link.href = URL.createObjectURL(blob);
          link.download = "invoice_records.csv";
          link.click();
        });
    </script>
  </body>
</html>
